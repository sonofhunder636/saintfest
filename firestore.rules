rules_version = '2';
service cloud.firestore {
  match /databases/{database}/documents {

    // Define admin email whitelist
    function isAdmin() {
      return request.auth != null && request.auth.token.email == 'andrewfisher1024@gmail.com';
    }

    // User documents - only admin can read/write
    match /users/{userId} {
      allow read, write: if isAdmin();
    }

    // Saints - public read, admin write
    match /saints/{saintId} {
      allow read: if true;  // Public read access for all visitors
      allow write: if isAdmin();
    }

    // Tournaments - public read, admin write
    match /tournaments/{tournamentId} {
      allow read: if true;  // Public read access for all visitors
      allow write: if isAdmin();
    }

    // Brackets - public read, admin write
    match /brackets/{bracketId} {
      allow read: if true;  // Public read access for all visitors
      allow write: if isAdmin();
    }

    // Categories - public read, admin write
    match /categories/{categoryId} {
      allow read: if true;  // Public read access for all visitors
      allow write: if isAdmin();
    }

    // Posts - public read, admin write
    match /posts/{postId} {
      allow read: if true;  // Public read access for all visitors
      allow write: if isAdmin();
    }

    // Polls - public read, admin write
    match /polls/{pollId} {
      allow read: if true;  // Public read access for all visitors
      allow write: if isAdmin();
    }

    // Votes - public read (for results), admin write
    match /votes/{voteId} {
      allow read: if true;  // Public read access for voting results
      allow write: if isAdmin();
    }

    // Published brackets - public read, admin write
    match /publishedBrackets/{bracketId} {
      allow read: if true;  // Public read access for all visitors
      allow write: if isAdmin();
    }

    // Tournament archives - public read, admin write
    match /tournamentArchives/{archiveId} {
      allow read: if true;  // Public read access for all visitors
      allow write: if isAdmin();
    }
  }
}